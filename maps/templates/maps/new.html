{% extends '../base.html' %}

{% load static %}
{% block content %}
	<script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=84f8fca347220d053f38cd40691e54c1&libraries=services,drawing"></script>
<center>
	<div>
		<div class="body-layout">
			<p class="enroll-announce">ì‚°ì±…ë¡œ ë“±ë¡</p>
			{% comment %} <img class="line-long" src="{% static 'maps/img/line.png' %}" /> {% endcomment %}
			{% comment %} ë§ˆì»¤, ì„  ì•ˆë‚´ {% endcomment %}
			<div class="new-announce">
				{% comment %} <span class="announcement">  âœï¸ ë§ˆì»¤ì™€ ì„ ì„ ì´ìš©í•´ ì§€ë„ ìœ„ì— ê²½ë¡œë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.</span> {% endcomment %}
				<div class="new-announce_announce">
					<div class="new-announce_first">
						<div class="new-announce_img">
							<img src="{% static 'maps/img/marker.png' %}" />
						</div>
						<div class="new-announce_desc">
							<span>ì§€ë„ ìœ„ ë§ˆì»¤ë¥¼ ì´ìš©í•´ íŠ¹ì´í•œ ìŠ¤íŒŸì„ ì°ì–´ì£¼ì„¸ìš”! í´ë¦­í•˜ë©´ í•€ì´ ì¶”ê°€ë˜ê³  ì„¤ëª…ì„ ì…ë ¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. </span>
						</div>
					</div>
					<div class="new-announce_second">
						<div class="new-announce_img">
							<img src="{% static 'maps/img/polyline.png' %}" />
						</div>
						<div class="new-announce_desc">
							<span>ì§€ë„ ìœ„ ì„ ì„ ì´ìš©í•´ ê²½ë¡œë¥¼ í‘œì‹œí•´ì£¼ì„¸ìš”! í´ë¦­í•˜ì—¬ <span class="warning">ì¶œë°œ ìœ„ì¹˜ë¶€í„°</span> ì„  ê·¸ë¦¬ê¸°ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤.</span>
						</div>
					</div>
				</div>
			</div>
	
			{% csrf_token %}
			<div class="mapbox mapbox-new">

				<div class="map-input">
					<div class="map-input_wrap">
						<input type="text" name="location" class ="map-input_location" id="address-location" placeholder="ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”! ex) ì‹ ë¦¼ë¡œ 1"/>
						<button type="submit" id="address-location-button" class="address-location-button">ì„¤ì •</button>
					</div>
					<button id="current-location-button" class="current-location-button"><img class="current-location-img" src="{% static 'maps/img/location.png' %}"></button>
				</div>
			</div>

			<div class="map_wrap">
				<div class="map-info">
					<p id="total-time">ğŸ•’ã…¤ì†Œìš” ì‹œê°„ : <span>0 ë¶„</span></p>
					<p id="total-distance">ğŸ“ã…¤ì´ ê±°ë¦¬ : <span>0 m</span></p>
				</div>
				{% comment %} ë§ˆì»¤ ì •ë³´ ì…ë ¥ {% endcomment %}
				<div id="info-input-container" class="marker-info" style="display: none">
					<div class="marker-info_location">
						<div class="marker-info_title">
							<input type="text" name="info-title" id="info-title-input" placeholder="ë§ˆì»¤ ì´ë¦„ì„ ë‹¬ì•„ì£¼ì„¸ìš”!"/>
						</div>
						<div class="marker-info_desc">
							<input type="text" name="info-description" id="info-description-input" placeholder="ë§ˆì»¤ ì„¤ëª…ì„ ë‹¬ì•„ì£¼ì„¸ìš”!"/>
						</div>
						<div class="marker-info-btn">
							<button type="submit" id="save-info-button" onclick="saveInfo()">ì €ì¥</button> 
						</div>
					</div>
				</div>
				
				<div id="loading" class="loading_new">
					<div class="loading-background_new">
						<div id="loading-bar-spinner" class="spinner">
							<div class="spinner-icon"></div>
						</div>
						<div class="loading-msg">ğŸ“í˜„ ìœ„ì¹˜ íŒŒì•… ì¤‘!</div>
					</div>
				</div>
				<div class="marker-line_box">
					<button id="marker-button" onclick="selectMarker()">ë§ˆì»¤</button>
					<button id="polyline-button" onclick="selectPolyline()">ì„ </button>
					<button id="undo" class="disabled" onclick="undo()" disabled>UNDO</button>
					<button id="redo" class="disabled" onclick="redo()" disabled>REDO</button>
				</div>
				<!-- ì§€ë„íƒ€ì… ì»¨íŠ¸ë¡¤ div ì…ë‹ˆë‹¤ -->
				<div class="custom_typecontrol radius_border type-control">
					<div id="btnRoadmap" class="selected_btn" onclick="setMapType('roadmap')">ì§€ë„</div>
					<div id="btnSkyview" class="btn" onclick="setMapType('skyview')">ìŠ¤ì¹´ì´ë·°</div>
				</div>
				<!-- ì§€ë„ í™•ëŒ€, ì¶•ì†Œ ì»¨íŠ¸ë¡¤ div ì…ë‹ˆë‹¤ -->
				<div class="custom_zoomcontrol radius_border zoom-control"> 
					<div class="zoom-btn" onclick="zoomIn()"><img src="https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/ico_plus.png" alt="í™•ëŒ€"></div>  
					<div class="zoom-btn" onclick="zoomOut()"><img src="https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/ico_minus.png" alt="ì¶•ì†Œ"></div>
				</div>
				<div id="map" style="width:100%;height:70vh;"></div>
			</div>
			
			<div class="input-box">
				<div class="input-box_wrap">
					<div class="name-box">
						<h4 class="title-name">ì‘ì„±ì</h4>
						<input type="text" name="username" id="username" class="input-mid-m input-name" value="{{ request.user.profile.username }}" disabled/>
					</div>
					<div class="title-desc-box">
						<div class="title-box">
							<h4 class="title-title">ì‚°ì±…ë¡œ ì´ë¦„</h4>
							<input type="text" name="title" id="title-input" class="input-mid-ml" placeholder="ì‚°ì±…ë¡œì˜ íŠ¹ì§•ì„ ë‹´ì€ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”."/>
						</div>
						<div class="desc-box">
							<h4 class="title-desc">ì‚°ì±…ë¡œ í•œ ì¤„ ì†Œê°œ</h4>
							<input type="text" name="description" id="description-input" class="input-mid-ml" placeholder="í•´ë‹¹ ì‚°ì±…ë¡œì˜ íŠ¹ì§•ì„ ì†Œê°œí•´ì£¼ì„¸ìš”."/>
						</div>
					</div>
					<div class="start-fin-box">
						<div class="start-box">
							<h4 class="title-start">ì¶œë°œìœ„ì¹˜</h4>
							<input type="text" name="start" id="start-input" class="input-mid-ml" placeholder="ì¶œë°œìœ„ì¹˜ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”. ex) ì„œìš¸ëŒ€ì…êµ¬ì—­ 5ë²ˆì¶œêµ¬ ì•"/>
						</div>
						<div class="fin-box">
							<h4 class="title-fin">ë„ì°©ìœ„ì¹˜</h4>
							<input type="text" name="finish" id="finish-input" class="input-mid-ml" placeholder="ë„ì°©ìœ„ì¹˜ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”. ex) ì„œìš¸ëŒ€í•™êµ ì •ë¬¸ ì•"/>
						</div>
					</div>
					<div class="tmi-box">
						<h4 class="title-tmi">TMI</h4>
						<input type="text" name="tmi" id="tmi-input" class="input-long input-long-m" placeholder="í•´ë‹¹ ì‚°ì±…ë¡œì— ëŒ€í•´ í•˜ê³  ì‹¶ì€ ë§ì„ ììœ ë¡­ê²Œ ì‘ì„±í•´ì£¼ì„¸ìš”!"/>
					</div>
					<div class="enroll-btn">
						<button type="submit" id="save-walkroad-button">ë“±ë¡í•˜ê¸°</button> 
					</div>
				</div>
			</div>
		</div>
	</div>
</center>
		
	{% if user.is_authenticated %}
    <script type="text/javascript">
        const userAddress = "{{ request.user.profile.location | safe }}";
    </script>
    {% else %}
    <script type="text/javascript">
        const userAddress = "ì‹ ë¦¼ë¡œ 1";
    </script>
    {% endif %}

    <script src="{% static 'maps/js/components.js' %}"></script>
    <script>        
        const geocoder = new kakao.maps.services.Geocoder();

        const container = document.getElementById('map');
        const options = {
            center: new kakao.maps.LatLng(33.450701, 126.570667),
            level: 4
        };

        const map = new kakao.maps.Map(container, options);

        let currentLocationMarker;
        let currentLocationInfowindow;

		const setCenterByCurrentLocation = true;
    </script>
    <script src="{% static 'maps/js/initial.js' %}"></script>
    <script src="{% static 'maps/js/new.js' %}"></script>
{% endblock content %}
